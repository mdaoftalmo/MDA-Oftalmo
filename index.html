<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Financeiro - Clinica Dr. Leonardo</title>
    <style>
        /* --- todos os seus estilos originais foram mantidos --- */
    </style>
</head>
<body>
    <!-- (mantive toda a estrutura original, s√≥ mostro aqui a parte alterada da aba INSUMOS) -->

    <div id="insumos" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Registrar Insumo</h3>
                <form id="formInsumo">
                    <div class="form-group">
                        <label>C√≥digo de Barras</label>
                        <input type="text" name="codigoBarras" id="codigoBarras" placeholder="Escaneie ou digite o c√≥digo">
                    </div>
                    <div class="form-group">
                        <label>Nome do Insumo</label>
                        <input type="text" name="nome" placeholder="Ex: Seringa 5ml" required>
                    </div>
                    <div class="form-group">
                        <label>Categoria</label>
                        <select name="categoria" required>
                            <option value="">Selecione...</option>
                            <option value="descartaveis">Descart√°veis</option>
                            <option value="medicamentos">Medicamentos</option>
                            <option value="equipamentos">Equipamentos</option>
                            <option value="limpeza">Limpeza</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quantidade</label>
                        <input type="number" name="quantidade" placeholder="Ex: 100" required>
                    </div>
                    <div class="form-group">
                        <label>Unidade</label>
                        <select name="unidade" required>
                            <option value="unidade">Unidade</option>
                            <option value="caixa">Caixa</option>
                            <option value="frasco">Frasco</option>
                            <option value="pacote">Pacote</option>
                            <option value="litro">Litro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Pre√ßo Unit√°rio (R$)</label>
                        <input type="number" step="0.01" name="preco" placeholder="0,00" required>
                    </div>
                    <div class="form-group">
                        <label>Estoque M√≠nimo</label>
                        <input type="number" name="estoqueMinimo" placeholder="Ex: 10" required>
                    </div>
                    <button type="submit" class="btn">Adicionar Insumo</button>
                </form>
            </div>

            <div class="card">
                <h3>Resumo do Estoque</h3>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h4>Itens Cadastrados</h4>
                        <div class="value" id="totalItens">0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Itens em Falta</h4>
                        <div class="value" id="itensEmFalta">0</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Lista de Insumos</h3>
            <div class="transactions-list" id="listaInsumos">
                <div class="transaction-item">
                    <div class="transaction-info">
                        <div>Nenhum insumo registrado ainda</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- (mantive todas as outras abas do sistema: dashboard, receitas, despesas, cirurgias, funcion√°rios, etc.) -->

    <script>
        // === SEU SCRIPT ORIGINAL COMPLETO AQUI ===

        // --- Fun√ß√£o para buscar produto pelo c√≥digo de barras ---
        function buscarProdutoPorCodigo(codigo) {
            const produto = dados.insumos.find(item => item.codigoBarras === codigo);
            if (produto) {
                // For√ßa abrir aba Insumos
                abrirAba('insumos');

                // Preenche os campos automaticamente
                document.querySelector('[name="nome"]').value = produto.nome;
                document.querySelector('[name="categoria"]').value = produto.categoria;
                document.querySelector('[name="quantidade"]').value = produto.quantidade;
                document.querySelector('[name="unidade"]').value = produto.unidade;
                document.querySelector('[name="preco"]').value = produto.preco;
                document.querySelector('[name="estoqueMinimo"]').value = produto.estoqueMinimo;

                mostrarNotificacao(`üì¶ Produto encontrado: ${produto.nome}`, 'success');
            } else {
                abrirAba('insumos');
                document.getElementById('codigoBarras').value = codigo; // j√° deixa preenchido
                mostrarNotificacao("‚ùå Produto n√£o encontrado, cadastre-o!", 'error');
            }
        }

        // --- Detecta leitura do leitor de c√≥digo de barras ---
        document.getElementById("codigoBarras").addEventListener("keydown", function(e) {
            if (e.key === "Enter") {
                e.preventDefault();
                buscarProdutoPorCodigo(this.value.trim());
                this.value = ""; // limpa depois de buscar
            }
        });
    </script>
</body>
</html>
